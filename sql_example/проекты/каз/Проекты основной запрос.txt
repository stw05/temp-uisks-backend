SELECT
o.number AS 'ИРН',
o.topickaz AS 'Название проекта',
a.name_kz as 'Заявитель',
pr.name_kz AS 'Приоритет',
ct.name AS 'Тип финансирования',
b.request_total AS 'Сумма финансирования (запр)', -- запрашиваемая
b.accept_total AS 'Сумма финансирования (одобр)', -- одобренная
CASE 
        WHEN ci.city IN ('Алматы', 'Almaty') THEN 'Алматы қаласы'
        WHEN ci.city IN ('Астана', 'Астана (Нур-Султан)', 'Nur-Sultan', 'Astana') THEN 'Астана қаласы'
        WHEN ci.city IN ('Шымкент', 'Shymkent') THEN 'Шымкент қаласы'
        WHEN ci.city IN ('Семей', 'Semey') THEN 'Абай облысы'
        WHEN ci.city IN ('Жезказган', 'Zhezkazgan') THEN 'Ұлытау облысы'
        WHEN ci.city IN ('Талдыкорган', 'Taldykorgan') THEN 'Жетісу Облысы'
        ELSE s.name
    END AS 'Регион заявителя',
os.name_kz AS 'статус',
CONCAT_WS('-',year(o.year_b),year(o.year_e)) AS 'Период'


from obj_main o
LEFT JOIN applicants a on a.id=o.applicant_id
LEFT join obj_priorities op on op.obj_id=o.id
LEFT JOIN priorities pr on pr.id=op.priority_id
LEFT JOIN competition_types ct ON o.comp_type_id = ct.id
LEFT JOIN budget b ON o.id = b.obj_id
LEFT JOIN states s ON a.state_id = s.id
LEFT join cities ci ON ci.id=a.city_id
LEFT join obj_status os ON o.status = os.id 

